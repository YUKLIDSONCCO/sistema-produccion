# ========================================
# üîí SEGURIDAD Y REESCRITURA MVC LIMPIA
# ========================================
Options -Indexes
RewriteEngine On
RewriteBase /sistema-produccion/public/

# ========================================
# üö´ BLOQUEAR ACCESO DIRECTO A index.php
# ========================================
# Si alguien intenta acceder con "index.php", redirigir al formato limpio
RewriteCond %{THE_REQUEST} \s/+index\.php[\s?] [NC]
RewriteRule ^index\.php(.*)$ /sistema-produccion/public/ [R=301,L]

# ========================================
# üìÇ ENRUTAMIENTO MVC LIMPIO
# ========================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/?([^/]*)/?$ index.php?controller=$1&action=$2 [L,QSA]

# ========================================
# üõ°Ô∏è BLOQUEAR ARCHIVOS Y CARPETAS SENSIBLES
# ========================================
<FilesMatch "\.(env|log|ini|json|lock|config|sql)$">
    Require all denied
</FilesMatch>

RedirectMatch 403 ^/sistema-produccion/(core|controllers|models|config)/.*
